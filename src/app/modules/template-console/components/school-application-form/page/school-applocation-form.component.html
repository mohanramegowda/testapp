<!--Vertical steppers are used for responsiveness. Any changes done in the steppers of horizontal stepper
     should be moved to vertical stepper as well the content of vertical stepper is exact copy of the 
     horizontal stepper-->

<ng-template #editFormFieldsStepContent>
    <items-toolbar [dataSource]="dataSource" (change)="changeViewType($event)"></items-toolbar>
    <mat-tree [dataSource]="dataSource" [treeControl]="treeControl">
        <mat-tree-node *matTreeNodeDef="let node" matTreeNodeToggle matTreeNodePadding>
            <button mat-icon-button disabled></button>
            <mat-checkbox class="checklist-leaf-node" [checked]="checklistSelection.isSelected(node)"
                (change)="treeLeafItemSelectionToggle(node)">{{node.name}}</mat-checkbox>
            <button mat-icon-button (click)="EditCategory(node)">
                <mat-icon>edit</mat-icon>
            </button>
            <button mat-icon-button (click)="RemoveChildItem(node)">
                <mat-icon>delete</mat-icon>
            </button>
            <button mat-icon-button (click)="CategoryDetailsReadOnly(node)">
                <mat-icon>remove_red_eye</mat-icon>
            </button>
            <button mat-icon-button (click)="addNewItem(node)">
                <mat-icon>settings</mat-icon>
            </button>
        </mat-tree-node>

        <mat-tree-node *matTreeNodeDef="let node; when: hasNoContent; let i = index" matTreeNodePadding>
            <button mat-icon-button disabled></button>
            <mat-form-field appearance="fill">
                <mat-label>New item...</mat-label>
                <input matInput #itemValue placeholder="Ex. Lettuce">
            </mat-form-field>
            <button mat-button (click)="saveNode(node, itemValue.value)">Save</button>
        </mat-tree-node>

        <mat-tree-node *matTreeNodeDef="let node; when: hasChild" matTreeNodePadding>
            <button mat-icon-button matTreeNodeToggle [attr.aria-label]="'toggle ' + node.filename">
                <mat-icon class="mat-icon-rtl-mirror">
                    {{treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'}}
                </mat-icon>
            </button>
            <mat-checkbox [checked]="descendantsAllSelected(node)" [indeterminate]="descendantsPartiallySelected(node)"
                (change)="treeItemSelectionToggle(node)">{{node.name}}</mat-checkbox>
            <button mat-icon-button (click)="addNewItem(node)">
                <mat-icon>add</mat-icon>
            </button>
            <button mat-icon-button (click)="EditCategory(node)">
                <mat-icon>edit</mat-icon>
            </button>
            <button mat-icon-button (click)="RemoveChildItem(node)">
                <mat-icon>delete</mat-icon>
            </button>
            <button mat-icon-button (click)="ShowChildFilter(node)">
                <mat-icon>filter_list</mat-icon>
            </button>
            <button mat-icon-button (click)="CategoryDetailsReadOnly(node)">
                <mat-icon>remove_red_eye</mat-icon>
            </button>
            <button mat-icon-button (click)="addNewItem(node)">
                <mat-icon>settings</mat-icon>
            </button>
        </mat-tree-node>
    </mat-tree>
</ng-template>
<ng-template #previewAndSubmitStepContent>
    <!-- School Preview & submit content starts from here-->
    <mat-horizontal-stepper #previewStepper fxShow="true" fxHide.lt-md="true">
        <mat-step *ngFor="let section of sections; let i = index">
            <ng-template matStepLabel>{{section.title}}</ng-template>
            <div fxLayout="row wrap" fxLayout.sm="column" fxLayout.xs="column" fxLayoutGap="1%" fxLayoutGap.xs="15px"
                fxLayoutGap.sm="15px" fxLayoutAlign="stretch stretch">
                <ng-container *ngIf="section.fields">
                    <div class="example-container" fxFlex="48%" fxFlex.sm="98%" fxFlex.xs="98%"
                        fxLayoutAlign="center center" *ngFor="let field of section.fields">
                        <mat-form-field appearance="fill">
                            <mat-label>{{field.label}}</mat-label>
                            <!--This is the placeholder for the dynamic form-->
                            <input matInput [placeholder]="field.name" required>
                            <!-- <mat-error *ngIf="form.controls['name'].errors?.required">
                                    Please enter field name
                                </mat-error> -->
                        </mat-form-field>
                    </div>
                </ng-container>

            </div>
            <div align="center" fxLayoutGap="10px">
                <button mat-stroked-button matStepperPrevious *ngIf="i > 0">Back</button>
                <button mat-stroked-button matStepperNext *ngIf="i < sections.length-1">Next</button>
                <button mat-stroked-button matStepperNext *ngIf="i === sections.length-1">Submit</button>
            </div>
        </mat-step>
    </mat-horizontal-stepper>
    <mat-vertical-stepper #previewStepper fxShow="true" fxHide.gt-sm="true">
        <mat-step *ngFor="let section of sections; let i = index">
            <ng-template matStepLabel>{{section.title}}</ng-template>
            <div fxLayout="row wrap" fxLayout.sm="column" fxLayout.xs="column" fxLayoutGap=0 fxLayoutGap.xs="15px"
                fxLayoutGap.sm="15px" fxLayoutAlign="stretch stretch">
                <ng-container *ngIf="section.fields">
                    <div class="example-container" fxFlex="48%" fxFlex.sm="98%" fxFlex.xs="98%"
                        fxLayoutAlign="center center" *ngFor="let field of section.fields">
                        <mat-form-field appearance="fill">
                            <mat-label>{{field.label}}</mat-label>
                            <!-- todo This is the placeholder for the dynamic form-->
                            <input matInput [placeholder]="field.name" required>
                            <!-- <mat-error *ngIf="form.controls['name'].errors?.required">
                                        Please enter field name
                                    </mat-error> -->
                        </mat-form-field>
                    </div>
                </ng-container>

            </div>
            <div align="center" fxLayoutGap="10px">
                <button mat-stroked-button matStepperPrevious *ngIf="i > 0">Back</button>
                <button mat-stroked-button matStepperNext *ngIf="i < sections.length-1">Next</button>
                <button mat-stroked-button matStepperNext *ngIf="i === sections.length-1">Submit</button>
            </div>
        </mat-step>
    </mat-vertical-stepper>
    <!-- School Preview & submit content ends here-->
</ng-template>
<div class="full-height">

    <mat-horizontal-stepper #stepper fxShow="true" fxHide.lt-md="true">

        <mat-step>
            <ng-template matStepLabel>Edit Form Fields and Sections</ng-template>
            <ng-container *ngTemplateOutlet="editFormFieldsStepContent"></ng-container>
            <div align="right">
                <button mat-stroked-button class="stroked-button" matStepperNext>Next</button>
            </div>
        </mat-step>
        <mat-step>
            <ng-template matStepLabel>Preview & Submit</ng-template>
            <ng-container *ngTemplateOutlet="previewAndSubmitStepContent"></ng-container>
            <div align="right" fxLayoutGap="10px">
                <button mat-stroked-button class="stroked-button" matStepperPrevious>Back</button>
                <button mat-stroked-button class="stroked-button" matStepperNext>Submit</button>
            </div>
        </mat-step>

    </mat-horizontal-stepper>

    <mat-vertical-stepper #stepper fxShow="true" fxHide.gt-sm="true">
        <mat-step>
            <ng-template matStepLabel>Edit Form Fields and Sections</ng-template>
            <ng-container *ngTemplateOutlet="editFormFieldsStepContent"></ng-container>
            <div align="right">
                <button mat-stroked-button class="stroked-button" matStepperNext>Next</button>
            </div>
        </mat-step>
        <mat-step>
            <ng-template matStepLabel>Preview & Submit</ng-template>
            <ng-container *ngTemplateOutlet="previewAndSubmitStepContent"></ng-container>
            <div align="right" fxLayoutGap="10px">
                <button mat-stroked-button class="stroked-button" matStepperPrevious>Back</button>
                <button mat-stroked-button class="stroked-button" matStepperNext>Submit</button>
            </div>
        </mat-step>
    </mat-vertical-stepper>


</div>